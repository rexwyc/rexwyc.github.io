<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚àû Preposition Master - Infinite Mode</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .game-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 900px;
            overflow: hidden;
        }

        .game-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .game-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .game-header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .infinity-symbol {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 3em;
            opacity: 0.2;
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .stats-bar {
            background: #f8f9fa;
            padding: 20px;
            display: flex;
            justify-content: space-around;
            border-bottom: 1px solid #e9ecef;
            flex-wrap: wrap;
            gap: 10px;
        }

        .stat-item {
            text-align: center;
            min-width: 100px;
        }

        .stat-label {
            font-size: 0.9em;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #495057;
        }

        .stat-value.highlight {
            color: #667eea;
            animation: pulse 1s ease;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .game-area {
            padding: 40px;
        }

        .mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .mode-btn {
            padding: 12px 24px;
            border: 2px solid #667eea;
            border-radius: 30px;
            background: white;
            color: #667eea;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .mode-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .mode-btn.active {
            background: #667eea;
            color: white;
        }

        .mode-btn.infinity {
            border-color: #ff6b6b;
            color: #ff6b6b;
        }

        .mode-btn.infinity:hover,
        .mode-btn.infinity.active {
            background: #ff6b6b;
            color: white;
        }

        .stats-extra {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f1f3f5;
            border-radius: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .accuracy-meter {
            flex: 1;
            min-width: 200px;
        }

        .accuracy-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            color: #495057;
        }

        .accuracy-bar-bg {
            background: #dee2e6;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
        }

        .accuracy-bar-fill {
            background: linear-gradient(90deg, #51cf66, #667eea);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .timer {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
            background: white;
            padding: 10px 20px;
            border-radius: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .timer.warning {
            color: #ff6b6b;
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .preposition-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .preposition-word {
            font-size: 4em;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .preposition-translation {
            font-size: 1.5em;
            opacity: 0.9;
        }

        .question-box {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 1.6em;
            color: #495057;
            margin-bottom: 30px;
            line-height: 1.6;
            text-align: center;
            font-weight: 500;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .option-btn {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            font-size: 1.1em;
            color: #495057;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .option-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .option-btn:hover:not(:disabled)::before {
            transform: translateX(0);
        }

        .option-btn:hover:not(:disabled) {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .option-btn.selected {
            background: #667eea;
            border-color: #667eea;
            color: white;
        }

        .option-btn.correct {
            background: #51cf66;
            border-color: #51cf66;
            color: white;
        }

        .option-btn.wrong {
            background: #ff6b6b;
            border-color: #ff6b6b;
            color: white;
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        .option-prefix {
            font-weight: bold;
            margin-right: 15px;
            min-width: 30px;
            font-size: 1.2em;
        }

        .feedback-box {
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.3em;
            display: none;
            animation: slideIn 0.3s ease;
        }

        .feedback-box.show {
            display: block;
        }

        .feedback-correct {
            background: #d3f9d8;
            color: #2b8e3c;
            border: 2px solid #51cf66;
        }

        .feedback-wrong {
            background: #ffe3e3;
            color: #c92a2a;
            border: 2px solid #ff6b6b;
        }

        .next-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 40px;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
            width: fit-content;
            font-weight: 600;
        }

        .next-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .next-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .achievement-toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #51cf66 0%, #667eea 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transform: translateX(400px);
            transition: transform 0.5s ease;
            z-index: 1000;
            font-weight: 600;
        }

        .achievement-toast.show {
            transform: translateX(0);
        }

        @media (max-width: 600px) {
            .game-area {
                padding: 20px;
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .preposition-word {
                font-size: 3em;
            }
            
            .question-text {
                font-size: 1.3em;
            }
            
            .stats-bar {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1>‚àû Preposition Master</h1>
            <p>Endless learning - Infinite practice!</p>
            <div class="infinity-symbol">‚àû</div>
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-label">Score</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Questions</div>
                <div class="stat-value" id="questionCounter">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Streak</div>
                <div class="stat-value" id="streak">0</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Best Streak</div>
                <div class="stat-value" id="bestStreak">0</div>
            </div>
        </div>

        <div class="game-area">
            <div class="mode-selector">
                <button class="mode-btn active" onclick="setMode('simple')">Simple</button>
                <button class="mode-btn" onclick="setMode('complex')">Complex</button>
                <button class="mode-btn" onclick="setMode('mixed')">Mixed</button>
                <button class="mode-btn infinity" onclick="setMode('infinity')">‚àû Infinite</button>
            </div>

            <div class="stats-extra">
                <div class="accuracy-meter">
                    <div class="accuracy-label">
                        <span>Accuracy</span>
                        <span id="accuracyPercentage">0%</span>
                    </div>
                    <div class="accuracy-bar-bg">
                        <div class="accuracy-bar-fill" id="accuracyBar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="timer" id="timer">‚è±Ô∏è 0:00</div>
            </div>

            <div id="questionContainer"></div>
        </div>
    </div>

    <div class="achievement-toast" id="achievementToast"></div>

    <script>
        // Prepositions data (keeping the same data structure)
        const prepositionsData = {
            simple_prepositions: [
                {"id": 1, "preposition": "about", "translation": "ÈóúÊñº", "usage_question": "We talked ___ the movie.", "options": ["A. about", "B. on", "C. at"], "correct": "A"},
                {"id": 2, "preposition": "above", "translation": "Âú®...‰πã‰∏ä", "usage_question": "The clock is ___ the door.", "options": ["A. above", "B. below", "C. under"], "correct": "A"},
                {"id": 3, "preposition": "across", "translation": "Á©øÈÅé", "usage_question": "He walked ___ the street.", "options": ["A. across", "B. through", "C. over"], "correct": "A"},
                {"id": 4, "preposition": "after", "translation": "Âú®...‰πãÂæå", "usage_question": "We will go to the park ___ lunch.", "options": ["A. after", "B. before", "C. during"], "correct": "A"},
                {"id": 5, "preposition": "against", "translation": "ÂèçÂ∞çÔºõÈù†Ëëó", "usage_question": "He leaned his bike ___ the wall.", "options": ["A. against", "B. for", "C. with"], "correct": "A"},
                {"id": 6, "preposition": "along", "translation": "Ê≤øËëó", "usage_question": "We walked ___ the beach.", "options": ["A. along", "B. across", "C. through"], "correct": "A"},
                {"id": 7, "preposition": "alongside", "translation": "Âú®...ÊóÅÈÇä", "usage_question": "The boat was docked ___ the pier.", "options": ["A. alongside", "B. away", "C. above"], "correct": "A"},
                {"id": 8, "preposition": "amid", "translation": "Âú®...‰πã‰∏≠", "usage_question": "The flowers bloomed ___ the ruins.", "options": ["A. amid", "B. between", "C. among"], "correct": "A"},
                {"id": 9, "preposition": "among", "translation": "Âú®...‰πãÈñì (‰∏âËÄÖÊàñ‰ª•‰∏ä)", "usage_question": "She was sitting ___ her friends.", "options": ["A. among", "B. between", "C. into"], "correct": "A"},
                {"id": 10, "preposition": "around", "translation": "ÂúçÁπûÔºõÂ§ßÁ¥Ñ", "usage_question": "We sat ___ the campfire.", "options": ["A. around", "B. through", "C. across"], "correct": "A"},
                {"id": 11, "preposition": "as", "translation": "‰ΩúÁÇ∫", "usage_question": "He works ___ a teacher.", "options": ["A. as", "B. like", "C. for"], "correct": "A"},
                {"id": 12, "preposition": "at", "translation": "Âú® (Âú∞Èªû/ÊôÇÈñì)", "usage_question": "I will meet you ___ the station.", "options": ["A. at", "B. in", "C. on"], "correct": "A"},
                {"id": 13, "preposition": "before", "translation": "Âú®...‰πãÂâç", "usage_question": "Please arrive ___ 8 o'clock.", "options": ["A. before", "B. after", "C. until"], "correct": "A"},
                {"id": 14, "preposition": "behind", "translation": "Âú®...ÂæåÈù¢", "usage_question": "The car is parked ___ the house.", "options": ["A. behind", "B. in front of", "C. beside"], "correct": "A"},
                {"id": 15, "preposition": "below", "translation": "Âú®...‰∏ãÈù¢", "usage_question": "The temperature is ___ freezing.", "options": ["A. below", "B. above", "C. over"], "correct": "A"},
                {"id": 16, "preposition": "beneath", "translation": "Âú®...‰∏ãÊñπ", "usage_question": "They found treasure ___ the sand.", "options": ["A. beneath", "B. above", "C. onto"], "correct": "A"},
                {"id": 17, "preposition": "beside", "translation": "Âú®...ÊóÅÈÇä", "usage_question": "She sat ___ her brother.", "options": ["A. beside", "B. besides", "C. between"], "correct": "A"},
                {"id": 18, "preposition": "between", "translation": "Âú®...‰πãÈñì (ÂÖ©ËÄÖ)", "usage_question": "The bank is ___ the post office and the library.", "options": ["A. between", "B. among", "C. amid"], "correct": "A"},
                {"id": 19, "preposition": "beyond", "translation": "Ë∂ÖÂá∫ÔºõÂú®...ËºÉÈÅ†ÁöÑ‰∏ÄÈÇä", "usage_question": "The mountains are ___ the horizon.", "options": ["A. beyond", "B. across", "C. through"], "correct": "A"},
                {"id": 20, "preposition": "by", "translation": "Á∂ìÁî±ÔºõÂú®...ÊóÅÈÇäÔºõ‰∏çÊôöÊñº", "usage_question": "The book was written ___ Mark Twain.", "options": ["A. by", "B. from", "C. with"], "correct": "A"},
                {"id": 21, "preposition": "despite", "translation": "ÂÑòÁÆ°", "usage_question": "We enjoyed the picnic ___ the rain.", "options": ["A. despite", "B. because of", "C. due to"], "correct": "A"},
                {"id": 22, "preposition": "down", "translation": "Âêë‰∏ã", "usage_question": "They walked ___ the hill.", "options": ["A. down", "B. up", "C. over"], "correct": "A"},
                {"id": 23, "preposition": "during", "translation": "Âú®...ÊúüÈñì", "usage_question": "He fell asleep ___ the movie.", "options": ["A. during", "B. while", "C. for"], "correct": "A"},
                {"id": 24, "preposition": "except", "translation": "Èô§‰∫Ü", "usage_question": "Everyone came ___ John.", "options": ["A. except", "B. including", "C. besides"], "correct": "A"},
                {"id": 25, "preposition": "for", "translation": "ÁÇ∫‰∫ÜÔºõÂ∞çÊñº", "usage_question": "This gift is ___ you.", "options": ["A. for", "B. to", "C. at"], "correct": "A"},
                {"id": 26, "preposition": "from", "translation": "Âæû", "usage_question": "I am ___ Canada.", "options": ["A. from", "B. of", "C. by"], "correct": "A"},
                {"id": 27, "preposition": "in", "translation": "Âú®...Ë£°Èù¢", "usage_question": "She lives ___ a small apartment.", "options": ["A. in", "B. at", "C. on"], "correct": "A"},
                {"id": 28, "preposition": "inside", "translation": "Âú®...ÂÖßÈÉ®", "usage_question": "Please wait ___ the building.", "options": ["A. inside", "B. outside", "C. beside"], "correct": "A"},
                {"id": 29, "preposition": "into", "translation": "ÈÄ≤ÂÖ•", "usage_question": "She walked ___ the room.", "options": ["A. into", "B. onto", "C. in"], "correct": "A"},
                {"id": 30, "preposition": "like", "translation": "ÂÉè", "usage_question": "He runs ___ the wind.", "options": ["A. like", "B. as", "C. for"], "correct": "A"},
                {"id": 31, "preposition": "near", "translation": "Èù†Ëøë", "usage_question": "The school is ___ the park.", "options": ["A. near", "B. far from", "C. beyond"], "correct": "A"},
                {"id": 32, "preposition": "of", "translation": "ÁöÑ", "usage_question": "The color ___ the sky is blue.", "options": ["A. of", "B. for", "C. with"], "correct": "A"},
                {"id": 33, "preposition": "off", "translation": "Èõ¢ÈñãÔºõËÑ´Èõ¢", "usage_question": "Please turn ___ the lights.", "options": ["A. off", "B. on", "C. over"], "correct": "A"},
                {"id": 34, "preposition": "on", "translation": "Âú®...‰πã‰∏ä (Êé•Ëß∏)", "usage_question": "The book is ___ the table.", "options": ["A. on", "B. in", "C. at"], "correct": "A"},
                {"id": 35, "preposition": "onto", "translation": "Âà∞...‰πã‰∏ä", "usage_question": "The cat jumped ___ the roof.", "options": ["A. onto", "B. into", "C. upon"], "correct": "A"},
                {"id": 36, "preposition": "opposite", "translation": "Âú®...Â∞çÈù¢", "usage_question": "The bank is ___ the station.", "options": ["A. opposite", "B. beside", "C. behind"], "correct": "A"},
                {"id": 37, "preposition": "out", "translation": "ÂêëÂ§ñ", "usage_question": "She looked ___ the window.", "options": ["A. out", "B. in", "C. through"], "correct": "A"},
                {"id": 38, "preposition": "outside", "translation": "Âú®...Â§ñÈù¢", "usage_question": "They waited ___ the theater.", "options": ["A. outside", "B. inside", "C. within"], "correct": "A"},
                {"id": 39, "preposition": "over", "translation": "Âú®...‰∏äÊñπÔºõË∂ÖÈÅé", "usage_question": "The bridge goes ___ the river.", "options": ["A. over", "B. under", "C. below"], "correct": "A"},
                {"id": 40, "preposition": "past", "translation": "Á∂ìÈÅé", "usage_question": "He walked ___ me without speaking.", "options": ["A. past", "B. passed", "C. over"], "correct": "A"},
                {"id": 41, "preposition": "plus", "translation": "Âä†‰∏ä", "usage_question": "Two ___ two equals four.", "options": ["A. plus", "B. minus", "C. times"], "correct": "A"},
                {"id": 42, "preposition": "since", "translation": "Ëá™Âæû", "usage_question": "I haven't seen her ___ Monday.", "options": ["A. since", "B. for", "C. from"], "correct": "A"},
                {"id": 43, "preposition": "than", "translation": "ÊØî", "usage_question": "She is taller ___ her brother.", "options": ["A. than", "B. then", "C. to"], "correct": "A"},
                {"id": 44, "preposition": "through", "translation": "Á©øÈÅé", "usage_question": "We drove ___ the tunnel.", "options": ["A. through", "B. across", "C. over"], "correct": "A"},
                {"id": 45, "preposition": "throughout", "translation": "ÈÅçÂèäÔºõÂú®Êï¥ÂÄãÊúüÈñì", "usage_question": "The news spread ___ the country.", "options": ["A. throughout", "B. through", "C. across"], "correct": "A"},
                {"id": 46, "preposition": "till", "translation": "Áõ¥Âà∞", "usage_question": "We waited ___ 10 PM.", "options": ["A. till", "B. since", "C. by"], "correct": "A"},
                {"id": 47, "preposition": "to", "translation": "ÂêëÔºõÂà∞", "usage_question": "I gave the book ___ her.", "options": ["A. to", "B. for", "C. at"], "correct": "A"},
                {"id": 48, "preposition": "toward", "translation": "ÊúùÂêë", "usage_question": "She walked ___ the door.", "options": ["A. toward", "B. away from", "C. at"], "correct": "A"},
                {"id": 49, "preposition": "under", "translation": "Âú®...‰∏ãÈù¢", "usage_question": "The cat is hiding ___ the bed.", "options": ["A. under", "B. over", "C. above"], "correct": "A"},
                {"id": 50, "preposition": "underneath", "translation": "Âú®...Â∫ï‰∏ã", "usage_question": "He wore a vest ___ his jacket.", "options": ["A. underneath", "B. above", "C. over"], "correct": "A"},
                {"id": 51, "preposition": "unlike", "translation": "‰∏çÂÉè", "usage_question": "___ his brother, he is very shy.", "options": ["A. Unlike", "B. Like", "C. Dislike"], "correct": "A"},
                {"id": 52, "preposition": "until", "translation": "Áõ¥Âà∞", "usage_question": "We will wait ___ you arrive.", "options": ["A. until", "B. by", "C. from"], "correct": "A"},
                {"id": 53, "preposition": "up", "translation": "Âêë‰∏ä", "usage_question": "She climbed ___ the ladder.", "options": ["A. up", "B. down", "C. over"], "correct": "A"},
                {"id": 54, "preposition": "upon", "translation": "Âú®...‰πã‰∏ä", "usage_question": "Once ___ a time...", "options": ["A. upon", "B. up", "C. on"], "correct": "A"},
                {"id": 55, "preposition": "via", "translation": "Á∂ìÁî±", "usage_question": "We flew to Paris ___ London.", "options": ["A. via", "B. through", "C. by"], "correct": "A"},
                {"id": 56, "preposition": "with", "translation": "ÂíåÔºõÁî®", "usage_question": "I went ___ my friends.", "options": ["A. with", "B. without", "C. and"], "correct": "A"},
                {"id": 57, "preposition": "within", "translation": "Âú®...‰πãÂÖß", "usage_question": "You must finish ___ an hour.", "options": ["A. within", "B. without", "C. outside"], "correct": "A"},
                {"id": 58, "preposition": "without", "translation": "Ê≤íÊúâ", "usage_question": "He left ___ saying goodbye.", "options": ["A. without", "B. with", "C. for"], "correct": "A"}
            ],
            complex_prepositions: [
                {"id": 59, "preposition": "according to", "translation": "Ê†πÊìö", "usage_question": "___ the weather forecast, it will rain.", "options": ["A. According to", "B. Because of", "C. Due to"], "correct": "A"},
                {"id": 60, "preposition": "ahead of", "translation": "Âú®...‰πãÂâç", "usage_question": "She finished her work ___ schedule.", "options": ["A. ahead of", "B. in front of", "C. prior to"], "correct": "A"},
                {"id": 61, "preposition": "apart from", "translation": "Èô§...‰πãÂ§ñ", "usage_question": "___ the weather, everything was perfect.", "options": ["A. Apart from", "B. Except for", "C. Including"], "correct": "A"},
                {"id": 62, "preposition": "as for", "translation": "Ëá≥Êñº", "usage_question": "___ me, I don't mind waiting.", "options": ["A. As for", "B. As to", "C. For"], "correct": "A"},
                {"id": 63, "preposition": "as per", "translation": "ÊåâÁÖß", "usage_question": "We will proceed ___ your instructions.", "options": ["A. as per", "B. according", "C. due to"], "correct": "A"},
                {"id": 64, "preposition": "as to", "translation": "ÈóúÊñº", "usage_question": "There is some doubt ___ his ability.", "options": ["A. as to", "B. as for", "C. as per"], "correct": "A"},
                {"id": 65, "preposition": "aside from", "translation": "Èô§...‰πãÂ§ñ", "usage_question": "___ the cost, it's a good idea.", "options": ["A. Aside from", "B. Because of", "C. Instead of"], "correct": "A"},
                {"id": 66, "preposition": "because of", "translation": "Âõ†ÁÇ∫", "usage_question": "The game was canceled ___ the rain.", "options": ["A. because of", "B. despite", "C. due to the fact that"], "correct": "A"},
                {"id": 67, "preposition": "close to", "translation": "Êé•Ëøë", "usage_question": "Our hotel was ___ the beach.", "options": ["A. close to", "B. far from", "C. next"], "correct": "A"},
                {"id": 68, "preposition": "contrary to", "translation": "Ëàá...Áõ∏Âèç", "usage_question": "___ popular belief, he is very kind.", "options": ["A. Contrary to", "B. According to", "C. Opposite to"], "correct": "A"},
                {"id": 69, "preposition": "depending on", "translation": "ÂèñÊ±∫Êñº", "usage_question": "We'll go hiking ___ the weather.", "options": ["A. depending on", "B. due to", "C. regardless of"], "correct": "A"},
                {"id": 70, "preposition": "different from", "translation": "Ëàá...‰∏çÂêå", "usage_question": "My opinion is ___ yours.", "options": ["A. different from", "B. similar to", "C. the same as"], "correct": "A"},
                {"id": 71, "preposition": "due to", "translation": "Áî±Êñº", "usage_question": "The delay was ___ traffic.", "options": ["A. due to", "B. because", "C. as"], "correct": "A"},
                {"id": 72, "preposition": "due to the fact that", "translation": "Áî±Êñº...ÁöÑ‰∫ãÂØ¶", "usage_question": "He succeeded ___ he worked hard.", "options": ["A. due to the fact that", "B. because of", "C. despite"], "correct": "A"},
                {"id": 73, "preposition": "except for", "translation": "Èô§...‰πãÂ§ñ", "usage_question": "The room was empty ___ a chair.", "options": ["A. except for", "B. apart", "C. besides"], "correct": "A"},
                {"id": 74, "preposition": "in addition to", "translation": "Èô§...‰πãÂ§ñ (ÈÇÑÊúâ)", "usage_question": "___ English, she speaks French.", "options": ["A. In addition to", "B. Apart from", "C. Except for"], "correct": "A"},
                {"id": 75, "preposition": "in case of", "translation": "Â¶ÇÊûúÁôºÁîü", "usage_question": "___ fire, break the glass.", "options": ["A. In case of", "B. In the event", "C. Because of"], "correct": "A"},
                {"id": 76, "preposition": "in front of", "translation": "Âú®...ÂâçÈù¢", "usage_question": "There is a garden ___ the house.", "options": ["A. in front of", "B. behind", "C. next to"], "correct": "A"},
                {"id": 77, "preposition": "in lieu of", "translation": "‰ª£Êõø", "usage_question": "He gave us a gift certificate ___ cash.", "options": ["A. in lieu of", "B. instead", "C. in place"], "correct": "A"},
                {"id": 78, "preposition": "in place of", "translation": "‰ª£Êõø", "usage_question": "She spoke ___ her boss.", "options": ["A. in place of", "B. instead", "C. in lieu"], "correct": "A"},
                {"id": 79, "preposition": "in spite of", "translation": "ÂÑòÁÆ°", "usage_question": "We had fun ___ the rain.", "options": ["A. in spite of", "B. because of", "C. due to"], "correct": "A"},
                {"id": 80, "preposition": "instead of", "translation": "ËÄå‰∏çÊòØ", "usage_question": "Let's play chess ___ watching TV.", "options": ["A. instead of", "B. in spite of", "C. because of"], "correct": "A"},
                {"id": 81, "preposition": "on board", "translation": "Âú®Ëàπ‰∏ä/È£õÊ©ü‰∏ä/ÁÅ´Ëªä‰∏ä", "usage_question": "Welcome ___ the flight to Paris.", "options": ["A. on board", "B. in board", "C. at board"], "correct": "A"},
                {"id": 82, "preposition": "on top of", "translation": "Âú®...È†ÇÁ´Ø", "usage_question": "Put the book ___ the others.", "options": ["A. on top of", "B. on the top", "C. at top of"], "correct": "A"},
                {"id": 83, "preposition": "next to", "translation": "Âú®...ÊóÅÈÇä", "usage_question": "The hotel is ___ the airport.", "options": ["A. next to", "B. near to", "C. close"], "correct": "A"},
                {"id": 84, "preposition": "on account of", "translation": "Âõ†ÁÇ∫", "usage_question": "The match was postponed ___ rain.", "options": ["A. on account of", "B. in spite of", "C. due"], "correct": "A"},
                {"id": 85, "preposition": "on behalf of", "translation": "‰ª£Ë°®", "usage_question": "I am writing ___ my company.", "options": ["A. on behalf of", "B. instead", "C. in behalf"], "correct": "A"},
                {"id": 86, "preposition": "opposite to", "translation": "Âú®...Â∞çÈù¢", "usage_question": "The bank is ___ the post office.", "options": ["A. opposite to", "B. opposite", "C. in front of"], "correct": "A"},
                {"id": 87, "preposition": "out of", "translation": "Âæû...Âá∫‰æÜÔºõÁº∫‰πè", "usage_question": "She ran ___ the house.", "options": ["A. out of", "B. out from", "C. out off"], "correct": "A"},
                {"id": 88, "preposition": "outside of", "translation": "Âú®...Â§ñÈù¢", "usage_question": "They live ___ the city.", "options": ["A. outside of", "B. outside", "C. out of"], "correct": "A"},
                {"id": 89, "preposition": "prior to", "translation": "Âú®...‰πãÂâç", "usage_question": "All arrangements were made ___ the event.", "options": ["A. prior to", "B. prior", "C. after"], "correct": "A"},
                {"id": 90, "preposition": "regardless of", "translation": "‰∏çÁÆ°", "usage_question": "We will go ___ the weather.", "options": ["A. regardless of", "B. despite of", "C. in spite"], "correct": "A"},
                {"id": 91, "preposition": "subsequent to", "translation": "Âú®...‰πãÂæå", "usage_question": "___ the meeting, we had lunch.", "options": ["A. Subsequent to", "B. Prior to", "C. Previous to"], "correct": "A"},
                {"id": 92, "preposition": "thanks to", "translation": "Âπ∏Ëôß", "usage_question": "___ your help, we finished on time.", "options": ["A. Thanks to", "B. Because", "C. Due"], "correct": "A"},
                {"id": 93, "preposition": "together with", "translation": "Âíå...‰∏ÄËµ∑", "usage_question": "He, ___ his friends, is coming.", "options": ["A. together with", "B. along", "C. together"], "correct": "A"}
            ]
        };

        // Game state
        let currentMode = 'simple';
        let score = 0;
        let streak = 0;
        let bestStreak = 0;
        let totalQuestions = 0;
        let correctAnswers = 0;
        let answerSelected = false;
        let startTime = Date.now();
        let timerInterval;

        // Initialize game
        function initGame() {
            resetGame();
            displayNewQuestion();
            startTimer();
        }

        // Reset game state
        function resetGame() {
            score = 0;
            streak = 0;
            totalQuestions = 0;
            correctAnswers = 0;
            answerSelected = false;
            updateStats();
        }

        // Set game mode
        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            resetGame();
            displayNewQuestion();
        }

        // Start timer
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 1000);
        }

        // Update timer
        function updateTimer() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            document.getElementById('timer').textContent = `‚è±Ô∏è ${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            // Add warning class after 5 minutes
            if (elapsed > 300) {
                document.getElementById('timer').classList.add('warning');
            }
        }

        // Update statistics
        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('questionCounter').textContent = totalQuestions;
            document.getElementById('streak').textContent = streak;
            document.getElementById('bestStreak').textContent = bestStreak;
            
            // Update accuracy
            const accuracy = totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) : 0;
            document.getElementById('accuracyPercentage').textContent = accuracy + '%';
            document.getElementById('accuracyBar').style.width = accuracy + '%';
        }

        // Get random question based on mode
        function getRandomQuestion() {
            let pool = [];
            
            if (currentMode === 'simple') {
                pool = prepositionsData.simple_prepositions;
            } else if (currentMode === 'complex') {
                pool = prepositionsData.complex_prepositions;
            } else if (currentMode === 'mixed') {
                pool = [...prepositionsData.simple_prepositions, ...prepositionsData.complex_prepositions];
            } else if (currentMode === 'infinity') {
                // In infinity mode, mix all prepositions and add some variations
                pool = [...prepositionsData.simple_prepositions, ...prepositionsData.complex_prepositions];
                
                // Occasionally shuffle options to create more variety
                if (Math.random() > 0.7) {
                    return createShuffledQuestion(pool[Math.floor(Math.random() * pool.length)]);
                }
            }
            
            return pool[Math.floor(Math.random() * pool.length)];
        }

        // Create a shuffled version of a question (for infinity mode)
        function createShuffledQuestion(original) {
            const shuffled = {...original};
            
            // Shuffle the options occasionally
            if (Math.random() > 0.5) {
                const options = [...original.options];
                for (let i = options.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [options[i], options[j]] = [options[j], options[i]];
                }
                
                // Update option letters
                shuffled.options = options.map((opt, index) => {
                    const letter = String.fromCharCode(65 + index); // A, B, C
                    return letter + opt.substring(1);
                });
                
                // Update correct answer letter
                const correctText = original.options.find(opt => opt[0] === original.correct);
                shuffled.correct = String.fromCharCode(65 + options.findIndex(opt => opt.substring(3) === correctText.substring(3)));
            }
            
            return shuffled;
        }

        // Display new question
        function displayNewQuestion() {
            const question = getRandomQuestion();
            const container = document.getElementById('questionContainer');
            
            container.innerHTML = `
                <div class="preposition-card">
                    <div class="preposition-word">${question.preposition}</div>
                    <div class="preposition-translation">${question.translation}</div>
                </div>
                <div class="question-box">
                    <div class="question-text">${question.usage_question}</div>
                    <div class="options-grid" id="optionsGrid">
                        ${question.options.map((opt, index) => `
                            <button class="option-btn" onclick="selectAnswer('${opt[0]}', this)">
                                <span class="option-prefix">${opt[0]}.</span>
                                ${opt.substring(3)}
                            </button>
                        `).join('')}
                    </div>
                    <div class="feedback-box" id="feedbackBox"></div>
                    <button class="next-btn" id="nextBtn" onclick="nextQuestion()" disabled>Next Question ‚Üí</button>
                </div>
            `;
            
            answerSelected = false;
        }

        // Handle answer selection
        function selectAnswer(selectedOption, element) {
            if (answerSelected) return;
            
            const question = getCurrentQuestionFromDOM();
            const correct = question.correct;
            const isCorrect = selectedOption === correct;
            
            // Update buttons
            const optionBtns = document.querySelectorAll('.option-btn');
            optionBtns.forEach(btn => {
                btn.disabled = true;
                const optLetter = btn.querySelector('.option-prefix').textContent[0];
                if (optLetter === correct) {
                    btn.classList.add('correct');
                } else if (optLetter === selectedOption && !isCorrect) {
                    btn.classList.add('wrong');
                }
            });
            
            // Show feedback
            const feedbackBox = document.getElementById('feedbackBox');
            feedbackBox.classList.add('show');
            
            totalQuestions++;
            
            if (isCorrect) {
                score += 10;
                streak++;
                correctAnswers++;
                
                if (streak > bestStreak) {
                    bestStreak = streak;
                    showAchievement(`üî• New Record! ${streak} Streak!`);
                }
                
                // Check for milestone achievements
                if (totalQuestions === 50) {
                    showAchievement("üéâ 50 Questions Master!");
                } else if (totalQuestions === 100) {
                    showAchievement("üèÜ 100 Questions Legend!");
                } else if (totalQuestions % 50 === 0) {
                    showAchievement(`‚≠ê ${totalQuestions} Questions! Keep going!`);
                }
                
                feedbackBox.classList.add('feedback-correct');
                feedbackBox.classList.remove('feedback-wrong');
                feedbackBox.innerHTML = '‚úÖ Correct! Well done!';
            } else {
                streak = 0;
                feedbackBox.classList.add('feedback-wrong');
                feedbackBox.classList.remove('feedback-correct');
                feedbackBox.innerHTML = `‚ùå Sorry, the correct answer is ${correct}. ${question.options.find(opt => opt[0] === correct)}`;
            }
            
            answerSelected = true;
            document.getElementById('nextBtn').disabled = false;
            updateStats();
        }

        // Show achievement toast
        function showAchievement(message) {
            const toast = document.getElementById('achievementToast');
            toast.textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Get current question from DOM
        function getCurrentQuestionFromDOM() {
            const questionText = document.querySelector('.question-text').textContent;
            const options = Array.from(document.querySelectorAll('.option-btn')).map(btn => {
                const prefix = btn.querySelector('.option-prefix').textContent;
                const text = btn.textContent.trim().substring(2);
                return prefix + ' ' + text;
            });
            
            // Find the question in the data
            const allPrepositions = [...prepositionsData.simple_prepositions, ...prepositionsData.complex_prepositions];
            return allPrepositions.find(q => q.usage_question === questionText) || {
                usage_question: questionText,
                options: options,
                correct: 'A' // Fallback
            };
        }

        // Move to next question
        function nextQuestion() {
            displayNewQuestion();
        }

        // Start the game
        initGame();
    </script>
</body>
</html>